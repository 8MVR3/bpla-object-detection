# üõ∞Ô∏è BPLA Object Detection with Prompting

## üìå –û–ø–∏—Å–∞–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞

–ü—Ä–æ–µ–∫—Ç —Ä–µ–∞–ª–∏–∑—É–µ—Ç —Å–∏—Å—Ç–µ–º—É –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏—è –æ–±—ä–µ–∫—Ç–æ–≤ –Ω–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è—Ö –∏ –≤–∏–¥–µ–æ —Å –±–µ—Å–ø–∏–ª–æ—Ç–Ω—ã—Ö –ª–µ—Ç–∞—Ç–µ–ª—å–Ω—ã—Ö –∞–ø–ø–∞—Ä–∞—Ç–æ–≤ (–ë–õ–ê). –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è YOLOv8 –∏ –º–µ—Ç–æ–¥—ã –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –ø—Ä–æ–º–ø—Ç–æ–≤ –¥–ª—è –∞–¥–∞–ø—Ç–∞—Ü–∏–∏ –º–æ–¥–µ–ª–∏ –ø–æ–¥ —Ä–∞–∑–Ω—ã–µ —É—Å–ª–æ–≤–∏—è.

–¶–µ–ª—å ‚Äî —Å–æ–∑–¥–∞—Ç—å –Ω–∞–¥—ë–∂–Ω—ã–π, –ø–µ—Ä–µ–Ω–æ—Å–∏–º—ã–π –∏ –≤–æ—Å–ø—Ä–æ–∏–∑–≤–æ–¥–∏–º—ã–π MLOps-–ø–∞–π–ø–ª–∞–π–Ω —Å –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ–º, —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ–º –≤–µ—Ä—Å–∏—è–º–∏ –¥–∞–Ω–Ω—ã—Ö –∏ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å—é —Ä–∞–∑–≤—ë—Ä—Ç—ã–≤–∞–Ω–∏—è –º–æ–¥–µ–ª–∏.

---

## ‚öôÔ∏è –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ –æ–∫—Ä—É–∂–µ–Ω–∏—è

### üìÅ –ö–ª–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è

```bash
git clone https://github.com/8MVR3/bpla-object-detection.git
cd bpla-object-detection
```

### üêç –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π

**–ß–µ—Ä–µ–∑ Poetry:**

```bash
poetry install
poetry shell
```

**–ß–µ—Ä–µ–∑ pip:**

```bash
pip install -r requirements.txt
```

### ‚úÖ –£—Å—Ç–∞–Ω–æ–≤–∫–∞ pre-commit —Ö—É–∫–æ–≤

```bash
pre-commit install
pre-commit run --all-files
```

---

## üèãÔ∏è‚Äç‚ôÇÔ∏è –û–±—É—á–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏

### üîß –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –æ–±—É—á–µ–Ω–∏—è

–ü–∞—Ä–∞–º–µ—Ç—Ä—ã –∑–∞–¥–∞—é—Ç—Å—è –≤ `configs/train.yaml`, –ø—Ä–∏–º–µ—Ä:

```yaml
epochs: 20
use_gpu: true
data:
    _target_: src.data.DataModule
    data_dir: data/
    batch_size: 32

model:
    _target_: src.models.DetectionModel
    lr: 0.001
```

### üöÄ –ó–∞–ø—É—Å–∫ –æ–±—É—á–µ–Ω–∏—è

```bash
python src/train.py
```

Hydra –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∑–∞–≥—Ä—É–∑–∏—Ç –Ω—É–∂–Ω—ã–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏.

---

## üîç –ò–Ω—Ñ–µ—Ä–µ–Ω—Å (ONNX)

### üîß –ê—Ä–≥—É–º–µ–Ω—Ç—ã:

-   `--model_path` ‚Äî –ø—É—Ç—å –∫ ONNX-–º–æ–¥–µ–ª–∏
-   `--input_dir` ‚Äî –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—è —Å `.jpg` –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è–º–∏
-   `--output_dir` ‚Äî –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—è –¥–ª—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤

### üöÄ –ü—Ä–∏–º–µ—Ä –∑–∞–ø—É—Å–∫–∞:

```bash
python src/infer.py \
  --model_path=exports/weights/best.onnx \
  --input_dir=data/test/images \
  --output_dir=outputs/
```

–§–∞–π–ª—ã –±—É–¥—É—Ç –æ–±—Ä–∞–±–æ—Ç–∞–Ω—ã –∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã –≤ `outputs/`. –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è `onnxruntime`, –±–µ–∑ PyTorch.

---

## üß† –≠–∫—Å–ø–æ—Ä—Ç –º–æ–¥–µ–ª–∏

### ‚û°Ô∏è –≠–∫—Å–ø–æ—Ä—Ç –≤ ONNX

```bash
python scripts/export_onnx.py --model models/best.pt --output models/model.onnx
```

### ‚û°Ô∏è –≠–∫—Å–ø–æ—Ä—Ç –≤ TensorRT (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)

```bash
bash scripts/build_engine.sh
```

–≠—Ç–æ—Ç —Å–∫—Ä–∏–ø—Ç –∏—Å–ø–æ–ª—å–∑—É–µ—Ç `trtexec` –¥–ª—è –∫–æ–º–ø–∏–ª—è—Ü–∏–∏ ONNX –≤ TensorRT engine-—Ñ–∞–π–ª. –¢—Ä–µ–±—É–µ—Ç—Å—è —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—ã–π TensorRT –∏ `trtexec` –≤ PATH.

---

## üìä –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ –º–µ—Ç—Ä–∏–∫–∏

–ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è MLflow –¥–ª—è –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è:

-   –º–µ—Ç—Ä–∏–∫: mAP, IoU, loss
-   –≥–∏–ø–µ—Ä–ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤
-   –º–æ–¥–µ–ª–∏ –∏ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–π

–ó–∞–ø—É—Å–∫ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞:

```bash
mlflow ui --port 8080
```

---

## üì¶ –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã–º–∏ (DVC)

DVC —É–ø—Ä–∞–≤–ª—è–µ—Ç –¥–∞–Ω–Ω—ã–º–∏ –∏ –º–æ–¥–µ–ª—å—é. –ö–æ–º–∞–Ω–¥—ã:

```bash
dvc pull        # –∑–∞–≥—Ä—É–∑–∏—Ç—å –¥–∞–Ω–Ω—ã–µ
# dvc add data/ # –¥–æ–±–∞–≤–∏—Ç—å –Ω–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ
# dvc push      # –≤—ã–≥—Ä—É–∑–∏—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è
```

–ù–∞—Å—Ç—Ä–æ–π—Ç–µ `.dvc/config` –∏ remote (–Ω–∞–ø—Ä–∏–º–µ—Ä, Google Drive).

---

## üóÉÔ∏è –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
bpla-object-detection/
‚îú‚îÄ‚îÄ configs/         # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ Hydra
‚îú‚îÄ‚îÄ data/            # –î–∞—Ç–∞—Å–µ—Ç (–ø–æ–¥ DVC)
‚îú‚îÄ‚îÄ models/          # –ú–æ–¥–µ–ª–∏ (YOLOv8 .pt, .onnx)
‚îú‚îÄ‚îÄ notebooks/       # Jupyter-–Ω–æ—É—Ç–±—É–∫–∏
‚îú‚îÄ‚îÄ outputs/         # –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –∏–Ω—Ñ–µ—Ä–µ–Ω—Å–∞
‚îú‚îÄ‚îÄ plots/           # –ì—Ä–∞—Ñ–∏–∫–∏ –∏ –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏
‚îú‚îÄ‚îÄ scripts/         # Bash-—Å–∫—Ä–∏–ø—Ç—ã
‚îÇ   ‚îî‚îÄ‚îÄ build_engine.sh  # –≠–∫—Å–ø–æ—Ä—Ç –≤ TensorRT
‚îú‚îÄ‚îÄ src/             # –ò—Å—Ö–æ–¥–Ω—ã–π –∫–æ–¥
‚îÇ   ‚îú‚îÄ‚îÄ data/        # DataModule
‚îÇ   ‚îú‚îÄ‚îÄ models/      # –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –º–æ–¥–µ–ª–∏
‚îÇ   ‚îú‚îÄ‚îÄ utils/       # –£—Ç–∏–ª–∏—Ç—ã
‚îÇ   ‚îú‚îÄ‚îÄ train.py     # –¢—Ä–µ–Ω–∏—Ä–æ–≤–∫–∞
‚îÇ   ‚îú‚îÄ‚îÄ infer.py     # ONNX-–∏–Ω—Ñ–µ—Ä–µ–Ω—Å
‚îú‚îÄ‚îÄ tests/           # –¢–µ—Å—Ç—ã
‚îú‚îÄ‚îÄ .gitignore
‚îú‚îÄ‚îÄ pyproject.toml
‚îî‚îÄ‚îÄ README.md
```

---

## üí° –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏

-   **–î–∞–Ω–Ω—ã–µ –∏ –º–æ–¥–µ–ª–∏ –Ω–µ –∫–æ–º–º–∏—Ç—å—Ç–µ –≤ Git** ‚Äî –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ DVC
-   **–ö–æ–Ω—Ñ–∏–≥–∏ ‚Äî —Ç–æ–ª—å–∫–æ –≤ `configs/` —á–µ—Ä–µ–∑ Hydra**
-   **–í–µ–¥–µ–Ω–∏–µ —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–æ–≤ ‚Äî —á–µ—Ä–µ–∑ MLflow**
-   **ONNX –∏ TensorRT ‚Äî –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω—ã, –Ω–æ –ø–æ–ª–µ–∑–Ω—ã –¥–ª—è –ø—Ä–æ–¥–∞–∫—à–Ω-–∏–Ω—Ñ–µ—Ä–µ–Ω—Å–∞**
-   **–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –∏ —é–Ω–∏—Ç-—Ç–µ—Å—Ç—ã ‚Äî –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã –∫ –ø–æ–¥–¥–µ—Ä–∂–∫–µ**

---

## üë§ –ê–≤—Ç–æ—Ä

–ü—Ä–æ–µ–∫—Ç —Å–æ–∑–¥–∞–Ω –≤ —Ä–∞–º–∫–∞—Ö –∫—É—Ä—Å–∞ **MLOps, –ú–§–¢–ò (–≤–µ—Å–Ω–∞ 2025)**
**–ê–≤—Ç–æ—Ä:** –í—è—á–µ—Å–ª–∞–≤ –ú–∏—Ö–æ–ª–∞–ø
**Email:** [mikholap.vv@phystech.edu](mailto:mikholap.vv@phystech.edu)
**GitHub:** [8MVR3](https://github.com/8MVR3)
